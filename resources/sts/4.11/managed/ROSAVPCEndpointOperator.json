{
    "Version": "2012-10-17",
    "Statement": [
      {
        "Sid": "DescribeListResources",
        "Effect": "Allow",
        "Action": [
          "ec2:DescribeTags",
          "ec2:DescribeSubnets",
          "ec2:DescribeSecurityGroups",
          "ec2:DescribeSecurityGroupRules",
          "ec2:DescribeVpcs",
          "ec2:DescribeVpcEndpoints",
          "route53:ListHostedZonesByName",
          "route53:ListResourceRecordSets",
          "route53:ListTagsForResource"
        ],
        "Resource": "*"
      },
      {
        "Sid": "ModifySGIngressEgress",
        "Effect": "Allow",
        "Action": [
          "ec2:AuthorizeSecurityGroupIngress",
          "ec2:AuthorizeSecurityGroupEgress"
        ],
        "Resource": "*"
      },
      {
        "Effect": "Allow",
        "Action": [
          "ec2:CreateSecurityGroup"
        ],
        "Resource": "*",
        "Condition": {
        "StringEquals": {
          "aws:RequestTag/red-hat-managed": "true"
          }
        }
      },
      {
        "Effect": "Allow",
        "Action": [
          "ec2:DeleteSecurityGroup"
        ],
        "Resource": "*",
        "Condition": {
        "StringEquals": {
          "aws:ResourceTag/red-hat-managed": "true"
          }
        }
      },
      {
        "Effect": "Allow",
        "Action": [
          "ec2:ModifyVpcEndpoint"
        ],
        "Resource": [
          "arn:aws:ec2:*:*:vpc-endpoint/*"
        ],
        "Condition": {
          "StringEquals": {
            "aws:ResourceTag/red-hat-managed": "true"
          }
        }
      },
      {
        "Effect": "Allow",
        "Action": [
          "ec2:DeleteVpcEndpoints"
        ],
        "Resource": [
          "arn:aws:ec2:*:*:vpc-endpoint/*"
        ],
        "Condition": {
          "StringEquals": {
            "aws:ResourceTag/red-hat-managed": "true"
          }
        }
      },
      {
        "Effect": "Allow",
        "Action": [
          "ec2:CreateVpcEndpoint"
        ],
        "Resource": [
          "arn:aws:ec2:*:*:vpc-endpoint/*"
        ],
        "Condition": {
          "StringEquals": {
            "aws:RequestTag/red-hat-managed": "true"
          }
        }
      },
      {
        "Sid": "ModifyRoute53",
        "Effect": "Allow",
        "Action": [
          "route53:CreateHostedZone",
          "route53:ChangeTagsForResource"
        ],
        "Resource": [
          "*"
        ]
      },
      {
        "Effect": "Allow",
        "Action": [
            "route53:ChangeResourceRecordSets"
        ],
        "Resource": "*",
        "Condition": {
            "ForAllValues:StringLike": {
                "route53:ChangeResourceRecordSetsNormalizedRecordNames": [
                  "*.openshiftapps.com",
                  "*.devshift.org",
                  "*.openshiftusgov.com",
                  "*.devshiftusgov.com"
                ]
            }
        }
      },
      {
        "Sid": "CreateTagsDependentAction",
        "Effect": "Allow",
        "Action": [
          "ec2:CreateTags"
        ],
        "Resource": [
          "arn:aws:ec2:*:*:security-group/*",
          "arn:aws:ec2:*:*:vpc-endpoint/*"
        ],
        "Condition": {
          "StringEquals": {
            "ec2:CreateAction": [
              "CreateVpcEndpoint",
              "CreateSecurityGroup"
            ]
          }
        }
      }
    ]
  }
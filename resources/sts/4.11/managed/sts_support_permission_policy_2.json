{
    "Version": "2012-10-17",
    "Statement": [
    {
        "Sid": "CreateNetworkInsightsPath",
        "Effect": "Allow",
        "Action": "ec2:CreateNetworkInsightsPath",
        "Resource": "arn:aws:ec2:*:*:network-insights-path/*",
        "Condition": {
            "StringEquals": {
                "aws:RequestTag/red-hat-managed": "true"
            }
        }
    },
    {
        "Sid": "DeleteNetworkInsightsPath",
        "Effect": "Allow",
        "Action": "ec2:DeleteNetworkInsightsPath",
        "Resource": "arn:aws:ec2:*:*:network-insights-path/*",
        "Condition": {
            "StringEquals": {
                "aws:ResourceTag/red-hat-managed": "true"
            }
        }
    },
    {
        "Sid": "DeleteNetworkInsightsAnalysis",
        "Effect": "Allow",
        "Action": "ec2:DeleteNetworkInsightsAnalysis",
        "Resource": "arn:aws:ec2:*:*:network-insights-analysis/*",
        "Condition": {
            "StringEquals": {
                "aws:ResourceTag/red-hat-managed": "true"
            }
        }
    },
    {
        "Sid": "RunInstances",
        "Effect": "Allow",
        "Action": "ec2:RunInstances",
        "Resource": "arn:aws:ec2:*:*:image/*",
        "Condition": {
            "StringEquals": {
                "aws:ResourceTag/red-hat-managed": "true"
            }
        }
    },
    {
        "Sid": "SearchTransitGatewayRoutes",
        "Effect": "Allow",
        "Action": "ec2:SearchTransitGatewayRoutes",
        "Resource": "arn:aws:ec2:*:*:transit-gateway-route-table/*",
        "Condition": {
            "StringEquals": {
                "aws:ResourceTag/red-hat-managed": "true"
            }
        }
    },
    {
        "Sid": "StartNetworkInsightsAnalysis",
        "Effect": "Allow",
        "Action": "ec2:StartNetworkInsightsAnalysis",
        "Resource": "arn:aws:ec2:*:*:network-insights-analysis/*",
        "Condition": {
            "StringEquals": {
                "aws:RequestTag/red-hat-managed": "true"
            }
        }
    },
    {
        "Sid": "StartInstances",
        "Effect": "Allow",
        "Action": "ec2:StartInstances",
        "Resource": "arn:aws:ec2:*:*:instance/*",
        "Condition": {
            "StringEquals": {
                "aws:ResourceTag/red-hat-managed": "true"
            }
        }
    },
    {
        "Sid": "StopInstances",
        "Effect": "Allow",
        "Action": "ec2:StopInstances",
        "Resource": "arn:aws:ec2:*:*:instance/*",
        "Condition": {
            "StringEquals": {
                "aws:ResourceTag/red-hat-managed": "true"
            }
        }
    },
    {
        "Sid": "TerminateInstances",
        "Effect": "Allow",
        "Action": "ec2:TerminateInstances",
        "Resource": "arn:aws:ec2:*:*:instance/*",
        "Condition": {
            "StringEquals": {
                "aws:ResourceTag/red-hat-managed": "true"
            }
        }
    },
    {
      "Sid": "Snapshot",
      "Effect": "Allow",
      "Action": [
        "ec2:CopySnapshot",
        "ec2:CreateSnapshot"
      ],
      "Resource": "arn:aws:ec2:*:*:snapshot/*",
      "Condition": {
        "StringEquals": {
          "aws:RequestTag/red-hat-managed": "true"
        }
      }
    },
    {
      "Sid": "CreateSnapshots",
      "Effect": "Allow",
      "Action": "ec2:CreateSnapshots",
      "Resource": "arn:aws:ec2:*:*:instance/*",
      "Condition": {
        "StringEquals": {
          "aws:ResourceTag/red-hat-managed": "true"
        }
      }
    }
  ]
}
